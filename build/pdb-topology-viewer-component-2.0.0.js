/**
 * pdb-topology-viewer
 * @version 2.0.0
 * @link https://github.com/PDBeurope/pdb-topology-viewer
 * @license Apache 2.0
 */
/**
 * Copyright 2020-2021 Mandar Deshpande <mandar@ebi.ac.uk>
 * European Bioinformatics Institute (EBI, http://www.ebi.ac.uk/)
 * European Molecular Biology Laboratory (EMBL, http://www.embl.de/)
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at 
 * http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, 
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and 
 * limitations under the License.
 */
"use strict";var __awaiter=this&&this.__awaiter||function(t,a,s,l){return new(s=s||Promise)(function(r,e){function n(t){try{o(l.next(t))}catch(t){e(t)}}function i(t){try{o(l.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?r(t.value):((e=t.value)instanceof s?e:new s(function(t){t(e)})).then(n,i)}o((l=l.apply(t,a||[])).next())})},__generator=this&&this.__generator||function(r,n){var i,o,a,t,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=2&e[0]?o.return:e[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,e[1])).done)return a;switch(o=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,o=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){s.label=e[1];break}if(6===e[0]&&s.label<a[1]){s.label=a[1],a=e;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(e);break}a[2]&&s.ops.pop(),s.trys.pop();continue}e=n.call(r,s)}catch(t){e=[6,t],o=0}finally{i=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},PdbTopologyViewerPlugin=function(){function t(){this.defaultColours={domainSelection:"rgb(255,0,0)",mouseOver:"rgb(105,105,105)",borderColor:"rgb(0,0,0)",qualityGreen:"rgb(0,182.85714285714286,0)",qualityRed:"rgb(291.42857142857144,0,0)",qualityYellow:"rgb(364.2857142857143,364.2857142857143,75.71428571428572)",qualityOrange:"rgb(291.42857142857144,121.42857142857143,0)"},this.svgWidth=100,this.svgHeight=100,this.createNewEvent=function(t){var n={};return t.forEach(function(t,e){var r;"function"==typeof MouseEvent?r=new MouseEvent(t,{view:window,bubbles:!0,cancelable:!0}):"function"==typeof document.createEvent&&(r=document.createEvent("MouseEvents")).initEvent(t,!0,!0),n[t]=r}),n},this.getAnnotationFromMappings=function(){var i=this;if(void 0!==this.apiData[2])for(var o=this.apiData[2][this.entryId],a=["UniProt","CATH","Pfam","SCOP"],t=function(t){if(void 0!==o[a[t]]&&0!==Object.entries(o[a[t]]).length){var e=[],r=o[a[t]];for(var n in r)r[n].mappings.forEach(function(t){t.entity_id==i.entityId&&t.chain_id==i.chainId&&e.push({start:t.start.residue_number,end:t.end.residue_number,color:void 0})});0<e.length&&s.domainTypes.push({label:a[t],data:e})}},s=this,e=0;e<3;e++)t(e)},this.createDomainDropdown=function(){if(this.domainTypes=[{label:"Annotation",data:null}],this.getAnnotationFromMappings(),this.getAnnotationFromOutliers(),this.selectedDomain=this.domainTypes[0],1<this.domainTypes.length){var r="";this.domainTypes.forEach(function(t,e){r=r+'<option value="'+e+'">'+t.label+"</option>"});var t=this.targetEle.querySelector(".menuSelectbox");t.innerHTML=r,t.addEventListener("change",this.highlightDomain.bind(this)),this.targetEle.querySelector(".resetIcon").addEventListener("click",this.resetDisplay.bind(this))}else this.targetEle.querySelector(".menuOptions").style.display="none"}}return t.prototype.render=function(t,e,r,n){var i=this;(t||r||e||n)&&(this.targetEle=t,this.targetEle.innerHTML="",this.entityId=e,this.entryId=r.toLowerCase(),this.chainId=n,this.getApiData(this.entryId,this.chainId).then(function(t){t&&(i.apiData=t,i.pdbevents=i.createNewEvent(["PDB.topologyViewer.click","PDB.topologyViewer.mouseover","PDB.topologyViewer.mouseout"]),i.getPDBSequenceArray(t[1][i.entryId]),i.drawTopologyStructures(),i.createDomainDropdown())}))},t.prototype.getApiData=function(r,n){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e=["https://www.ebi.ac.uk/pdbe/api/pdb/entry/observed_residues_ratio/"+r,"https://www.ebi.ac.uk/pdbe/api/pdb/entry/entities/"+r,"https://www.ebi.ac.uk/pdbe/api/mappings/"+r,"https://www.ebi.ac.uk/pdbe/api/topology/entry/"+r,"https://www.ebi.ac.uk/pdbe/api/validation/residuewise_outlier_summary/entry/"+r,"https://www.ebi.ac.uk/pdbe/api/pdb/entry/polymer_coverage/"+r+"/chain/"+n],[2,Promise.all(e.map(function(t){return fetch(t)})).then(function(t){return Promise.all(t.map(function(t){return t.json()}))})]})})},t.prototype.getPDBSequenceArray=function(t){for(var e=t.length,r=0;r<e;r++)t[r].entity_id==this.entityId&&(this.sequenceArr=t[r].sequence.split(""))},t.prototype.chunkArray=function(t,e){for(var r=[],n=0,i=t.length;n<i;)r.push(t.slice(n,n+=e));return r},t.prototype.getDomainRange=function(){var e=this,r=[],t=this.apiData[3][this.entryId][this.entityId][this.chainId];for(var n in t)t[n]&&t[n].forEach(function(t){void 0!==t.path&&0<t.path.length&&(r=r.concat(e.chunkArray(t.path,2)))});this.xScale=d3.scaleLinear().domain([d3.min(r,function(t){return t[0]}),d3.max(r,function(t){return t[0]})]).range([1,this.svgWidth-1]),this.yScale=d3.scaleLinear().domain([d3.min(r,function(t){return t[1]}),d3.max(r,function(t){return t[1]})]).range([1,this.svgHeight-1]),this.zoom=d3.zoom().on("zoom",function(){return e.zoomDraw()})},t.prototype.drawStrandSubpaths=function(t,e,r){for(var n=this,i=e-t+1,o=(this.scaledPointsArr[7]-this.scaledPointsArr[1])/i,a=[],s=0;s<i;s++){var l={type:"strands",elementIndex:r};0===s?(l.residue_number=t,l.pathData=[this.scaledPointsArr[4],this.scaledPointsArr[1],this.scaledPointsArr[4],this.scaledPointsArr[1]+o,this.scaledPointsArr[8],this.scaledPointsArr[1]+o,this.scaledPointsArr[8],this.scaledPointsArr[13]]):(l.residue_number=t+s,l.pathData=[a[s-1].pathData[2],a[s-1].pathData[3],a[s-1].pathData[2],a[s-1].pathData[3]+o,a[s-1].pathData[4],a[s-1].pathData[5]+o,a[s-1].pathData[4],a[s-1].pathData[5]]),a.push(l)}this.svgEle.selectAll(".subpath-strands"+r).remove(),this.svgEle.selectAll(".subpath-strands"+r).data(a).enter().append("path").attr("class",function(t,e){return"strandsSubPath subpath-strands"+r+" topo_res_"+t.residue_number}).attr("d",function(t,e){return"M "+t.pathData.join(" ")+" Z"}).attr("stroke","#111").attr("stroke-width","0").attr("fill","white").attr("fill-opacity","0").on("mouseover",function(t){n.mouseoverAction(this,t)}).on("mousemove",function(t){n.mouseoverAction(this,t)}).on("mouseout",function(t){n.mouseoutAction(this,t)}).on("click",function(t){n.clickAction(t)})},t.prototype.drawStrandMaskShape=function(r){var n=this.scaledPointsArr,t=[7,8,10,12],e=[0,1,2,3,4,5,9,11,13];n[0]>n[6]&&(t=[0,1,2,3,4,5,9,11,13],e=[7,8,10,12]);for(var i=t.length,o=0;o<i;o++)n[t[o]]=n[t[o]]+.3;for(var a=e.length,s=0;s<a;s++)n[e[s]]=n[e[s]]-.3;n[14]=n[8],n[15]=n[13],n[16]=n[8],n[17]=n[7],n[18]=n[4],n[19]=n[7],n[20]=n[4],n[21]=n[1],this.svgEle.selectAll(".maskpath-strands"+r).remove(),this.svgEle.selectAll(".maskpath-strands"+r).data([n]).enter().append("path").attr("class",function(t,e){return"strandMaskPath maskpath-strands"+r}).attr("d",function(t,e){return"M"+n.join(" ")+"Z"}).attr("stroke","#111").attr("stroke-width",.3).attr("fill","white").attr("stroke-opacity",0)},t.prototype.renderTooltip=function(t,e){var r=d3.select(".pdbTopologyTooltip");if(null==r._groups[0][0]&&(r=d3.select("body").append("div").attr("class","pdbTopologyTooltip").attr("style","display: none;width: auto;position: absolute;background: #fff;padding: 5px;border: 1px solid #666;border-radius: 5px;box-shadow: 5px 6px 5px 0 rgba(0,0,0,.17);font-size: .9em;color: #555;z-index: 998;")),"show"===e){var n=d3.event.pageX,i=d3.event.pageY,o="Residue "+t.residue_number+" ("+this.sequenceArr[t.residue_number-1]+")";void 0!==t.tooltipMsg&&(o=void 0!==t.tooltipPosition&&"postfix"===t.tooltipPosition?o+" "+t.tooltipMsg:t.tooltipMsg+" "+o),r.html(o).style("display","block").style("top",i+15+"px").style("left",n+10+"px")}else r.style("display","none")},t.prototype.dispatchEvent=function(t,e,r){var n=this.targetEle;void 0!==r&&(n=r),void 0!==e&&(this.pdbevents[t].eventData=e),n.dispatchEvent(this.pdbevents[t])},t.prototype.clickAction=function(t){this.dispatchEvent("PDB.topologyViewer.click",{residueNumber:t.residue_number,type:t.type,entryId:this.entryId,entityId:this.entityId,chainId:this.chainId})},t.prototype.mouseoverAction=function(t,e){var r=d3.select(t);this.renderTooltip(e,"show"),"strands"!==e.type&&"helices"!==e.type||r.attr("fill",this.defaultColours.mouseOver).attr("fill-opacity","0.3"),"coils"===e.type&&r.attr("stroke",this.defaultColours.mouseOver).attr("stroke-width",1),this.dispatchEvent("PDB.topologyViewer.mouseover",{residueNumber:e.residue_number,type:e.type,entryId:this.entryId,entityId:this.entityId,chainId:this.chainId})},t.prototype.mouseoutAction=function(t,e){var r="white",n=0,i=.3,o=d3.select(t);this.renderTooltip("","hide"),o.classed("coloured")?(r=o.attr("data-color"),i=n=1):"coils"===e.type&&(r=this.defaultColours.borderColor),"strands"!==e.type&&"helices"!==e.type||o.attr("fill",r).attr("fill-opacity",n),"coils"===e.type&&o.attr("stroke",r).attr("stroke-width",i),this.dispatchEvent("PDB.topologyViewer.mouseout",{entryId:this.entryId,entityId:this.entityId,chainId:this.chainId})},t.prototype.drawHelicesSubpaths=function(t,e,r,n){var i=this;var o=-5;this.scaledPointsArr[3]>this.scaledPointsArr[9]&&(o=5);var a=e-t+1;o=0;var s=(this.scaledPointsArr[9]-o-this.scaledPointsArr[3])/a,l=0,u=this.svgEle.select(".helices"+r).node().getBBox().height+s/2,c=u/a;l=(s=(u-c/2)/a)-c/10,this.scaledPointsArr[3]>this.scaledPointsArr[9]&&(l=-(u+c));for(var h=[],d={},p=0;p<a;p++)d={type:"helices"},0===p?(this.scaledPointsArr[3]>this.scaledPointsArr[9]?d.residue_number=e:d.residue_number=t,d.pathData=[this.scaledPointsArr[0],this.scaledPointsArr[3]+l,this.scaledPointsArr[4],this.scaledPointsArr[3]+l,this.scaledPointsArr[4],this.scaledPointsArr[3]+l+s,this.scaledPointsArr[0],this.scaledPointsArr[3]+l+s]):(this.scaledPointsArr[3]>this.scaledPointsArr[9]?d.residue_number=e-p:d.residue_number=t+p,d.pathData=[h[p-1].pathData[6],h[p-1].pathData[7],h[p-1].pathData[4],h[p-1].pathData[5],h[p-1].pathData[4],h[p-1].pathData[5]+s,h[p-1].pathData[6],h[p-1].pathData[5]+s]),h.push(d);this.svgEle.selectAll(".subpath-helices"+r).remove(),this.svgEle.selectAll(".subpath-helices"+r).data(h).enter().append("path").attr("class",function(t){return"helicesSubPath subpath-helices"+r+" topo_res_"+t.residue_number}).attr("d",function(t){return"M"+t.pathData.join(" ")+" Z"}).attr("stroke","#111").attr("stroke-width","0").attr("fill","white").attr("fill-opacity","0").on("mouseover",function(t){i.mouseoverAction(this,t)}).on("mousemove",function(t){i.mouseoverAction(this,t)}).on("mouseout",function(t){i.mouseoutAction(this,t)}).on("click",function(t){i.clickAction(t)})},t.prototype.drawHelicesMaskShape=function(e){var t=[[this.scaledPointsArr[0]-.3,this.scaledPointsArr[1],this.scaledPointsArr[2],this.scaledPointsArr[3]-.3,this.scaledPointsArr[4]+.3,this.scaledPointsArr[5],this.scaledPointsArr[4]+.3,this.scaledPointsArr[3],this.scaledPointsArr[0]-.3,this.scaledPointsArr[3]],[this.scaledPointsArr[6]+.3,this.scaledPointsArr[7],this.scaledPointsArr[8],this.scaledPointsArr[9]+.3,this.scaledPointsArr[10]-.3,this.scaledPointsArr[11],this.scaledPointsArr[10]-.3,this.scaledPointsArr[9],this.scaledPointsArr[6]+.3,this.scaledPointsArr[9]]];this.scaledPointsArr[3]>this.scaledPointsArr[9]&&(t=[[this.scaledPointsArr[0]-.3,this.scaledPointsArr[1],this.scaledPointsArr[2],this.scaledPointsArr[3]+2,this.scaledPointsArr[4]+.3,this.scaledPointsArr[5],this.scaledPointsArr[4]+.3,this.scaledPointsArr[3],this.scaledPointsArr[0]-.3,this.scaledPointsArr[3]],[this.scaledPointsArr[6]+.3,this.scaledPointsArr[7],this.scaledPointsArr[8],this.scaledPointsArr[9]-.3,this.scaledPointsArr[10]-.3,this.scaledPointsArr[11],this.scaledPointsArr[10]-.3,this.scaledPointsArr[9],this.scaledPointsArr[6]+.3,this.scaledPointsArr[9]]]),this.svgEle.selectAll(".maskpath-helices"+e).remove(),this.svgEle.selectAll(".maskpath-helices"+e).data(t).enter().append("path").attr("class",function(t){return"helicesMaskPath maskpath-helices"+e}).attr("d",function(t){return"M"+t[0]+" "+t[1]+" Q"+t[2]+" "+t[3]+" "+t[4]+" "+t[5]+" L"+t[6]+" "+t[7]+" "+t[8]+" "+t[9]+" Z"}).attr("stroke","#111").attr("stroke-width",.3).attr("fill","white").attr("stroke-opacity",0)},t.prototype.drawCoilsSubpaths=function(t,e,r){var n=this,i=this.svgEle.select(".coils"+r),o=e-t+1,a=i.node().getTotalLength()/o,s=[],l=void 0,u=void 0,c={};if(1==o)c={residue_number:t,type:"coils",pathData:n.scaledPointsArr,elementIndex:r},s.push(c);else for(var h=0;h<o;h++){var d=a*(h+1),p=i.node().getPointAtLength(d),f=i.node().getPathSegAtLength(d);c={residue_number:t+h,type:"coils",elementIndex:r},1===f?c.pathData=n.scaledPointsArr.slice(0,2):(void 0===u?c.pathData=n.scaledPointsArr.slice(0,2*f):(c.pathData=n.scaledPointsArr.slice(2*u,2*f),c.pathData.unshift(l.x,l.y)),l=p,u=f),c.pathData=c.pathData.concat([p.x,p.y]),s.push(c)}-1!==t&&-1!==e&&(this.svgEle.selectAll(".subpath-coils"+r).remove(),this.svgEle.selectAll(".subpath-coils"+r).data(s).enter().append("path").attr("class",function(t){return"coilsSubPath subpath-coils"+r+" topo_res_"+t.residue_number}).attr("d",function(t){return"M "+t.pathData.join(" ")}).attr("stroke",this.defaultColours.borderColor).attr("stroke-width",.3).attr("fill","none").attr("stroke-opacity","1").on("mouseover",function(t){n.mouseoverAction(this,t)}).on("mousemove",function(t){n.mouseoverAction(this,t)}).on("mouseout",function(t){n.mouseoutAction(this,t)}).on("click",function(t){n.clickAction(t)}),this.svgEle.selectAll(".coils"+r).attr("stroke-opacity",0));var v=this.apiData[3][this.entryId][this.entityId][this.chainId].terms,y=this.apiData[3][this.entryId][this.entityId][this.chainId].coils.length;if(0===r)this.svgEle.selectAll(".terminal_N").remove(),this.svgEle.selectAll(".terminal_N").data([v[0]]).enter().append("text").attr("class","terminals terminal_N").attr("text-anchor","middle").text("N").attr("x",s[0].pathData[0]).attr("y",s[0].pathData[1]).attr("stroke","#0000ff").attr("stroke-width","0.3").attr("font-size","3px").attr("style","-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Arial;");else if(r===y-1){var g=s[o-1].pathData.length,m=-2;s[o-1].pathData[g-1]>s[o-1].pathData[g-3]&&(m=2),this.svgEle.selectAll(".terminal_C").remove(),this.svgEle.selectAll(".terminal_C").data([v[1]]).enter().append("text").attr("class","terminals terminal_N").attr("text-anchor","middle").text("C").attr("x",s[o-1].pathData[g-2]).attr("y",s[o-1].pathData[g-1]+m).attr("stroke","#ff0000").attr("stroke-width","0.3").attr("font-size","3px").attr("style","-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Arial;")}},t.prototype.drawTopologyStructures=function(){var u=this;this.targetEle.innerHTML='<div style="border:1px solid #696969;">\n            <div class="svgSection" style="position:relative;width:100%;"></div>\n            <div class="menuSection" style="position:relative;height:38px;line-height:38px;background-color:#696969;padding: 0 10px;font-size:16px; color: #efefef;">\n                <img src="https://www.ebi.ac.uk/pdbe/entry/static/images/logos/PDBe/logo_T_64.png" style="height:15px; width: 15px; border:0;position: absolute;margin-top: 11px;" />\n                <a style="color: #efefef;border-bottom:none; cursor:pointer;margin-left: 16px;" target="_blank" href="https://pdbe.org/'+this.entryId+'">'+this.entryId+"</a> | Entity "+this.entityId+" | Chain "+this.chainId.toUpperCase()+'\n                <div class="menuOptions" style="float:right;margin-right: 20px;">\n                    <select class="menuSelectbox" style="margin-right: 10px;"><option value="">Select</option></select>\n                    <img class="resetIcon" src="images/refresh.png" style="height:15px; width: 15px; border:0;position: absolute;margin-top: 11px;cursor:pointer;" title="Reset view" />\n                </div>\n            </div>\n        </div>';var t=this.targetEle.offsetWidth,e=this.targetEle.offsetHeight,r=this.targetEle.querySelector(".svgSection"),n=e-40,i=t;r.style.height=n+"px";var o=n-20,a=i-5;r.innerHTML='<svg class="topoSvg" preserveAspectRatio="xMidYMid meet" viewBox="0 0 100 100" style="width:'+a+"px;height:"+o+'px;margin:10px 0;"></svg>',this.svgEle=d3.select(this.targetEle).select(".topoSvg"),this.getDomainRange(),this.scaledPointsArr=[],this.svgEle.call(this.zoom).on("contextmenu",function(t,e){d3.event.preventDefault()});function s(l){var t=c[l];if(!t)return{value:void 0};t.forEach(function(s,t){if(void 0!==s.path&&0<s.path.length&&"terms"!==l){var e=0;if("helices"===l){var r=s.path[0]+(s.path[2]-s.path[0])/2;e=1.3*s.minoraxis*2,s.path[1]>s.path[3]&&(e=1.3*s.minoraxis*-2);var n=[s.path[0],s.path[1],r,s.path[1]-e,s.path[2],s.path[1],s.path[2],s.path[3],r,s.path[3]+e,s.path[0],s.path[3]];s.path=n}s.secStrType=l,s.pathIndex=t;var i=u.svgEle.selectAll("path."+l+t).data([s]).enter().append("path").attr("class",function(){return-1===s.start&&-1===s.stop&&"terms"!==l?"dashedEle topologyEle "+l+" "+l+t+" topoEleRange_"+s.start+"-"+s.stop:"topologyEle "+l+" "+l+t+" topoEleRange_"+s.start+"-"+s.stop}).attr("d",function(t){for(var e="M",r=s.path.length,n=!0,i=0;i<r;i++){if("helices"!==l||2!==i&&8!==i||(e+=" Q"),("helices"===l&&6===i||"coils"===l&&s.path.length<12&&8===i)&&(e+=" L"),n){var o=u.xScale(s.path[i]);e+=" "+o,u.scaledPointsArr.push(o)}else{var a=u.yScale(s.path[i]);e+=" "+a,u.scaledPointsArr.push(a)}n=!n}return"strands"!==l&&"helices"!==l||(e+=" Z"),e}).attr("fill","none").attr("stroke-width",.3).attr("stroke",u.defaultColours.borderColor);-1===s.start&&-1===s.stop&&i.attr("stroke-dasharray","0.9"),"strands"===l&&(u.drawStrandSubpaths(s.start,s.stop,t),u.drawStrandMaskShape(t),u.svgEle._groups[0][0].append(i.node())),"helices"===l&&(u.drawHelicesSubpaths(s.start,s.stop,t,e),u.drawHelicesMaskShape(t),u.svgEle._groups[0][0].append(i.node())),"coils"===l&&u.drawCoilsSubpaths(s.start,s.stop,t),u.scaledPointsArr=[]}})}var c=this.apiData[3][this.entryId][this.entityId][this.chainId];for(var l in c){var h=s(l);if("object"==typeof h)return h.value}this.svgEle._groups[0][0].append(this.svgEle.selectAll(".validationResidue").node())},t.prototype.zoomDraw=function(){var e=this,s=d3.event.transform.rescaleX(this.xScale),l=d3.event.transform.rescaleY(this.yScale),u=this;u.scaledPointsArr=[];var t=this.svgEle.selectAll(".topologyEle"),c=0,h=0,d=0;t.each(function(t){d3.select(d3.select(this).node()).attr("d",function(t){c=t.pathIndex,h=t.start,d=t.stop;for(var e="M",r=t.path.length,n=!0,i=0;i<r;i++){if("helices"!==t.secStrType||2!==i&&8!==i||(e+=" Q"),("helices"===t.secStrType&&6===i||"coils"===t.secStrType&&t.path.length<12&&8===i)&&(e+=" L"),n){var o=s(t.path[i]);e+=" "+o,u.scaledPointsArr.push(o)}else{var a=l(t.path[i]);e+=" "+a,u.scaledPointsArr.push(a)}n=!n}return"strands"!==t.secStrType&&"helices"!==t.secStrType||(e+=" Z"),e}),"helices"===t.secStrType?(u.drawHelicesSubpaths(h,d,c,0),u.drawHelicesMaskShape(c),u.svgEle._groups[0][0].append(d3.select(this).node())):"strands"===t.secStrType?(u.drawStrandSubpaths(h,d,c),u.drawStrandMaskShape(c),u.svgEle._groups[0][0].append(d3.select(this).node())):"coils"===t.secStrType&&u.drawCoilsSubpaths(h,d,c),u.scaledPointsArr=[]});var a=0;this.svgEle.selectAll(".validationResidue").attr("transform",function(t){var e=u.svgEle.select(".topo_res_"+t.residue_number),r=e.node().getBBox(),n=e.data(),i={x:0,y:0};if("strands"===n[0].type||"helices"===n[0].type)i={x:r.x+r.width/2,y:r.y+r.height/2};else{var o=e.node().getPointAtLength(e.node().getTotalLength()/2);i={x:o.x,y:o.y}}return a=r.height/2,"translate("+i.x+","+i.y+")"}).attr("d",d3.symbol().type(function(t,e){return d3.symbols[0]}).size(a)),this.svgEle.selectAll(".residueSelection").attr("d",function(t){var e=d3.select(this).data();return u.svgEle.select(".topo_res_"+e[0].residueNumber).attr("d")}),this.svgEle._groups[0][0].querySelectorAll(".coilsSubPath").forEach(function(t){return e.svgEle._groups[0][0].append(t)}),this.svgEle._groups[0][0].querySelectorAll(".dashedEle").forEach(function(t){return e.svgEle._groups[0][0].append(t)}),this.highlightDomain("zoom"),this.svgEle._groups[0][0].querySelectorAll(".validationResidue").forEach(function(t){return e.svgEle._groups[0][0].append(t)}),this.svgEle._groups[0][0].querySelectorAll(".residueSelection").forEach(function(t){return e.svgEle._groups[0][0].append(t)})},t.prototype.drawValidationShape=function(t,e,r){var n=this,i=n.svgEle.select(".topo_res_"+t);if(null!=i._groups[0][0]){var o=i.node().getBBox(),a=i.data(),s={x:0,y:0};if("strands"===a[0].type||"helices"===a[0].type)s={x:o.x+o.width/2,y:o.y+o.height/2};else{var l=i.node().getPointAtLength(i.node().getTotalLength()/2);s={x:l.x,y:l.y}}var u={residue_number:t,tooltipMsg:"Validation issue: RSRZ <br>",tooltipPosition:"prefix"};this.svgEle.append("path").attr("class","validationResidue rsrz_"+t).data([u]).attr("fill",r).attr("stroke","#000").attr("stroke-width",.3).attr("transform",function(t){return"translate("+s.x+","+s.y+")"}).attr("d",d3.symbol().type(function(t,e){return d3.symbols[0]}).size(o.height/2)).style("display","none").on("mouseover",function(t){n.mouseoverAction(this,t)}).on("mousemove",function(t){n.mouseoverAction(this,t)}).on("mouseout",function(t){n.mouseoutAction(this,t)}).on("click",function(t){n.clickAction(t)})}},t.prototype.getChainStartAndEnd=function(){if(this.apiData[5]){for(var t=this.apiData[5][this.entryId].molecules[0].chains,r={start:0,end:0},e=t.length,n=0;n<e;n++)if(t[n].chain_id==this.chainId){t[n].observed.forEach(function(t,e){0==e?(r.start=t.start.residue_number,r.end=t.end.residue_number):(t.start.residue_number<r.start&&(r.start=t.start.residue_number),t.end.residue_number>r.end&&(r.end=t.end.residue_number))});break}return r}},t.prototype.getAnnotationFromOutliers=function(){var e=this,o=this,t=this.getChainStartAndEnd(),a=[{start:t.start,end:t.end,color:o.defaultColours.qualityGreen,tooltipMsg:"No validation issue reported for "}],s=[],l=[0];if(this.apiData[5]){var r=this.apiData[4][this.entryId];void 0!==r&&void 0!==r.molecules&&0<r.molecules.length&&(r.molecules.forEach(function(t){t.entity_id==e.entityId&&t.chains.forEach(function(t){t.chain_id==e.chainId&&t.models.forEach(function(t){t.residues.forEach(function(t){var e=o.defaultColours.qualityYellow,r="issue";if(1!==t.outlier_types.length||"RSRZ"!==t.outlier_types[0]){1===t.outlier_types.length?e=o.defaultColours.qualityYellow:r=(e=2===t.outlier_types.length?o.defaultColours.qualityOrange:o.defaultColours.qualityRed,"issues"),l.push(t.residue_number);var n="Validation "+r+": "+t.outlier_types.join(", ")+"<br>";-1<s.indexOf(t.residue_number)&&(n="Validation issues: "+t.outlier_types.join(", ")+", RSRZ<br>"),a.push({start:parseInt(t.residue_number),end:parseInt(t.residue_number),color:e,tooltipMsg:n,tooltipPosition:"prefix"})}else{e=o.defaultColours.qualityRed,o.drawValidationShape(t.residue_number,"circle",e),s.push(t.residue_number);var i=l.indexOf(t.residue_number);-1<i?a[i].tooltipMsg=a[i].tooltipMsg.replace("<br>",", RSRZ<br>"):(a.push({start:parseInt(t.residue_number),end:parseInt(t.residue_number),color:o.defaultColours.qualityGreen,tooltipMsg:"Validation issue: RSRZ <br>",tooltipPosition:"prefix"}),l.push(t.residue_number))}})})})}),0<a.length&&this.domainTypes.push({label:"Quality",data:a}))}},t.prototype.clearHighlight=function(){var o=this;this.svgEle.selectAll(".coloured").each(function(t){var e=d3.select(this),r=e.node();e.data()[0].tooltipMsg=void 0,e.data()[0].tooltipPosition=void 0;var n=d3.select(r).classed("coloured",!1),i=n.attr("class").split(" ");-1<i.indexOf("strandsSubPath")||-1<i.indexOf("helicesSubPath")?n.attr("fill","white").attr("fill-opacity",0):n.attr("stroke",o.defaultColours.borderColor).attr("stroke-width",.3)}),this.svgEle.selectAll(".validationResidue").style("display","none")},t.prototype.changeResidueColor=function(t,e,r,n){void 0===e&&(e=this.defaultColours.domainSelection);var i=this.svgEle.select(".topo_res_"+t);null!=i._groups[0][0]&&(i.data()[0].tooltipMsg=r,i.data()[0].tooltipPosition=n,i.attr("stroke",function(t){return"coils"===t.type?e:"#111"}).attr("stroke-width",function(t){return"coils"===t.type?1:0}).attr("fill",function(t){return"coils"===t.type?"none":e}).attr("fill-opacity",function(t){return"coils"===t.type?0:1}).classed("coloured",!0).attr("data-color",e))},t.prototype.highlightResidues=function(t){var r=this;t.forEach(function(t){for(var e=t.start;e<=t.end;e++)r.changeResidueColor(e,t.color,t.tooltipMsg,t.tooltipPosition)})},t.prototype.highlightDomain=function(t){var e=this.targetEle.querySelector(".menuSelectbox"),r=parseInt(e.value),n=this.domainTypes[r];null!==n.data?(this.clearHighlight(),this.highlightResidues(n.data),"Quality"===n.label&&this.svgEle.selectAll(".validationResidue").style("display","block")):"zoom"!==t&&this.clearHighlight()},t.prototype.resetDisplay=function(){this.targetEle.querySelector(".menuSelectbox").value=0,this.highlightDomain()},t}();window.PdbTopologyViewerPlugin=PdbTopologyViewerPlugin,function(r){var n={};function i(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return r[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}i.m=r,i.c=n,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=20)}([function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},function(e,t){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},r(t)}e.exports=r},function(n,t,e){var o=e(13);function i(t,e,r){return"undefined"!=typeof Reflect&&Reflect.get?n.exports=i=Reflect.get:n.exports=i=function(t,e,r){var n=o(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}},i(t,e,r||t)}n.exports=i},function(t,e,r){var n=r(6),i=r(12);t.exports=function(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?i(t):e}},function(t,e,r){var n=r(8);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)}},function(e,t){function r(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=r=function(t){return typeof t}:e.exports=r=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}e.exports=r},function(t,e,r){var n=r(14),i=r(15),o=r(16);t.exports=function(t){return n(t)||i(t)||o()}},function(r,t){function n(t,e){return r.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(t,e)}r.exports=n},function(t,e,r){t.exports=r(17)},function(t,e){function l(t,e,r,n,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void r(t)}s.done?e(l):Promise.resolve(l).then(n,i)}t.exports=function(s){return function(){var t=this,a=arguments;return new Promise(function(e,r){var n=s.apply(t,a);function i(t){l(n,e,r,i,o,"next",t)}function o(t){l(n,e,r,i,o,"throw",t)}i(void 0)})}}},function(e,t,r){var n=r(2),i=r(8),o=r(18),a=r(19);function s(t){var r="function"==typeof Map?new Map:void 0;return e.exports=s=function(t){if(null===t||!o(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,e)}function e(){return a(t,arguments,n(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),i(e,t)},s(t)}e.exports=s},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e,r){var n=r(2);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=n(t)););return t}},function(t,e){t.exports=function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}},function(t,e){t.exports=function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(t,e,r){var n=function(o){var t=Object.prototype,u=t.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},i=e.iterator||"@@iterator",r=e.asyncIterator||"@@asyncIterator",n=e.toStringTag||"@@toStringTag";function a(t,e,r,n){var o,a,s,l,i=e&&e.prototype instanceof p?e:p,u=Object.create(i.prototype),c=new S(n||[]);return u._invoke=(o=t,a=r,s=c,l="suspendedStart",function(t,e){if("executing"===l)throw new Error("Generator is already running");if("completed"===l){if("throw"===t)throw e;return P()}for(s.method=t,s.arg=e;;){var r=s.delegate;if(r){var n=_(r,s);if(n){if(n===d)continue;return n}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if("suspendedStart"===l)throw l="completed",s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);l="executing";var i=h(o,a,s);if("normal"===i.type){if(l=s.done?"completed":"suspendedYield",i.arg===d)continue;return{value:i.arg,done:s.done}}"throw"===i.type&&(l="completed",s.method="throw",s.arg=i.arg)}}),u}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}o.wrap=a;var d={};function p(){}function s(){}function l(){}var c={};c[i]=function(){return this};var f=Object.getPrototypeOf,v=f&&f(f(x([])));v&&v!==t&&u.call(v,i)&&(c=v);var y=l.prototype=p.prototype=Object.create(c);function g(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function m(l){var e;this._invoke=function(r,n){function t(){return new Promise(function(t,e){!function e(t,r,n,i){var o=h(l[t],l,r);if("throw"!==o.type){var a=o.arg,s=a.value;return s&&"object"==typeof s&&u.call(s,"__await")?Promise.resolve(s.__await).then(function(t){e("next",t,n,i)},function(t){e("throw",t,n,i)}):Promise.resolve(s).then(function(t){a.value=t,n(a)},function(t){return e("throw",t,n,i)})}i(o.arg)}(r,n,t,e)})}return e=e?e.then(t,t):t()}}function _(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method))return d;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var n=h(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,d;var i=n.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function b(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function w(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(b,this),this.reset(!0)}function x(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(u.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:P}}function P(){return{value:void 0,done:!0}}return s.prototype=y.constructor=l,l.constructor=s,l[n]=s.displayName="GeneratorFunction",o.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===s||"GeneratorFunction"===(e.displayName||e.name))},o.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,n in t||(t[n]="GeneratorFunction")),t.prototype=Object.create(y),t},o.awrap=function(t){return{__await:t}},g(m.prototype),m.prototype[r]=function(){return this},o.AsyncIterator=m,o.async=function(t,e,r,n){var i=new m(a(t,e,r,n));return o.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},g(y),y[n]="Generator",y[i]=function(){return this},y.toString=function(){return"[object Generator]"},o.keys=function(r){var n=[];for(var t in r)n.push(t);return n.reverse(),function t(){for(;n.length;){var e=n.pop();if(e in r)return t.value=e,t.done=!1,t}return t.done=!0,t}},o.values=x,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function t(t,e){return o.type="throw",o.arg=r,n.next=t,e&&(n.method="next",n.arg=void 0),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var i=this.tryEntries[e],o=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var a=u.call(i,"catchLoc"),s=u.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),w(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;w(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:x(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},o}(t.exports);try{regeneratorRuntime=n}catch(t){Function("r","regeneratorRuntime = r")(n)}},function(t,e){t.exports=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")}},function(n,t,e){var o=e(8);function i(t,e,r){return function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}}()?n.exports=i=Reflect.construct:n.exports=i=function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&o(i,r.prototype),i},i.apply(null,arguments)}n.exports=i},function(t,e,r){r.r(e);function o(t){return"function"==typeof t&&x.has(t)}function f(t,e){for(var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;e!==r;){var n=e.nextSibling;t.removeChild(e),e=n}}function O(t,e){M()(this,O),this.parts=[],this.element=e;for(var r=[],n=[],i=document.createTreeWalker(e.content,133,null,!1),o=0,a=-1,s=0,l=t.strings,u=t.values.length;s<u;){var c=i.nextNode();if(null!==c){if(a++,1===c.nodeType){if(c.hasAttributes()){for(var h=c.attributes,d=h.length,p=0,f=0;f<d;f++)V(h[f].name,"$lit$")&&p++;for(;0<p--;){var v=l[s],y=q.exec(v)[2],g=y.toLowerCase()+"$lit$",m=c.getAttribute(g);c.removeAttribute(g);var _=m.split(L);this.parts.push({type:"attribute",index:a,name:y,strings:_}),s+=_.length-1}}"TEMPLATE"===c.tagName&&(n.push(c),i.currentNode=c.content)}else if(3===c.nodeType){var b=c.data;if(0<=b.indexOf(R)){for(var w=c.parentNode,S=b.split(L),x=S.length-1,P=0;P<x;P++){var A=void 0,k=S[P];if(""===k)A=j();else{var E=q.exec(k);null!==E&&V(E[2],"$lit$")&&(k=k.slice(0,E.index)+E[1]+E[2].slice(0,-"$lit$".length)+E[3]),A=document.createTextNode(k)}w.insertBefore(A,c),this.parts.push({type:"node",index:++a})}""===S[x]?(w.insertBefore(j(),c),r.push(c)):c.data=S[x],s+=x}}else if(8===c.nodeType)if(c.data===R){var C=c.parentNode;null!==c.previousSibling&&a!==o||(a++,C.insertBefore(j(),c)),o=a,this.parts.push({type:"node",index:a}),null===c.nextSibling?c.data="":(r.push(c),a--),s++}else for(var T=-1;-1!==(T=c.data.indexOf(R,T+1));)this.parts.push({type:"node",index:-1}),s++}else i.currentNode=n.pop()}for(var N=0,I=r;N<I.length;N++){var D=I[N];D.parentNode.removeChild(D)}}function c(t){return-1!==t.index}function d(t){return null===t||!("object"===S()(t)||"function"==typeof t)}function p(t){return Array.isArray(t)||!(!t||!t[Symbol.iterator])}var n,i,a=r(0),M=r.n(a),s=r(1),l=r.n(s),u=r(4),h=r.n(u),v=r(2),y=r.n(v),g=r(3),m=r.n(g),_=r(5),b=r.n(_),w=r(6),S=r.n(w),x=new WeakMap,P=void 0!==window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,A={},k={},E=r(7),C=r.n(E),R="{{lit-".concat(String(Math.random()).slice(2),"}}"),T="\x3c!--".concat(R,"--\x3e"),L=new RegExp("".concat(R,"|").concat(T)),V=function(t,e){var r=t.length-e.length;return 0<=r&&t.slice(r)===e},j=function(){return document.createComment("")},q=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/,N=(l()(tt,[{key:"update",value:function(t){var e=0,r=!0,n=!1,i=void 0;try{for(var o,a=this.__parts[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var s=o.value;void 0!==s&&s.setValue(t[e]),e++}}catch(t){n=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}var l=!0,u=!1,c=void 0;try{for(var h,d=this.__parts[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var p=h.value;void 0!==p&&p.commit()}}catch(t){u=!0,c=t}finally{try{l||null==d.return||d.return()}finally{if(u)throw c}}}},{key:"_clone",value:function(){for(var t,e=P?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),r=[],n=this.template.parts,i=document.createTreeWalker(e,133,null,!1),o=0,a=0,s=i.nextNode();o<n.length;)if(t=n[o],c(t)){for(;a<t.index;)a++,"TEMPLATE"===s.nodeName&&(r.push(s),i.currentNode=s.content),null===(s=i.nextNode())&&(i.currentNode=r.pop(),s=i.nextNode());if("node"===t.type){var l=this.processor.handleTextExpression(this.options);l.insertAfterNode(s.previousSibling),this.__parts.push(l)}else{var u;(u=this.__parts).push.apply(u,C()(this.processor.handleAttributeExpressions(s,t.name,t.strings,this.options)))}o++}else this.__parts.push(void 0),o++;return P&&(document.adoptNode(e),customElements.upgrade(e)),e}}]),tt),I=" ".concat(R," "),D=(l()(K,[{key:"getHTML",value:function(){for(var t=this.strings.length-1,e="",r=!1,n=0;n<t;n++){var i=this.strings[n],o=i.lastIndexOf("\x3c!--");r=(-1<o||r)&&-1===i.indexOf("--\x3e",o+1);var a=q.exec(i);e+=null===a?i+(r?I:T):i.substr(0,a.index)+a[1]+a[2]+"$lit$"+a[3]+R}return e+this.strings[t]}},{key:"getTemplateElement",value:function(){var t=document.createElement("template");return t.innerHTML=this.getHTML(),t}}]),K),z=(l()(X,[{key:"_createPart",value:function(){return new H(this)}},{key:"_getValue",value:function(){for(var t=this.strings,e=t.length-1,r="",n=0;n<e;n++){r+=t[n];var i=this.parts[n];if(void 0!==i){var o=i.value;if(d(o)||!p(o))r+="string"==typeof o?o:String(o);else{var a=!0,s=!1,l=void 0;try{for(var u,c=o[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var h=u.value;r+="string"==typeof h?h:String(h)}}catch(t){s=!0,l=t}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}}}}return r+t[e]}},{key:"commit",value:function(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}]),X),H=(l()(Q,[{key:"setValue",value:function(t){t===A||d(t)&&t===this.value||(this.value=t,o(t)||(this.committer.dirty=!0))}},{key:"commit",value:function(){for(;o(this.value);){var t=this.value;this.value=A,t(this)}this.value!==A&&this.committer.commit()}}]),Q),B=(l()(J,[{key:"appendInto",value:function(t){this.startNode=t.appendChild(j()),this.endNode=t.appendChild(j())}},{key:"insertAfterNode",value:function(t){this.startNode=t,this.endNode=t.nextSibling}},{key:"appendIntoPart",value:function(t){t.__insert(this.startNode=j()),t.__insert(this.endNode=j())}},{key:"insertAfterPart",value:function(t){t.__insert(this.startNode=j()),this.endNode=t.endNode,t.endNode=this.startNode}},{key:"setValue",value:function(t){this.__pendingValue=t}},{key:"commit",value:function(){for(;o(this.__pendingValue);){var t=this.__pendingValue;this.__pendingValue=A,t(this)}var e=this.__pendingValue;e!==A&&(d(e)?e!==this.value&&this.__commitText(e):e instanceof D?this.__commitTemplateResult(e):e instanceof Node?this.__commitNode(e):p(e)?this.__commitIterable(e):e===k?(this.value=k,this.clear()):this.__commitText(e))}},{key:"__insert",value:function(t){this.endNode.parentNode.insertBefore(t,this.endNode)}},{key:"__commitNode",value:function(t){this.value!==t&&(this.clear(),this.__insert(t),this.value=t)}},{key:"__commitText",value:function(t){var e=this.startNode.nextSibling,r="string"==typeof(t=null==t?"":t)?t:String(t);e===this.endNode.previousSibling&&3===e.nodeType?e.data=r:this.__commitNode(document.createTextNode(r)),this.value=t}},{key:"__commitTemplateResult",value:function(t){var e=this.options.templateFactory(t);if(this.value instanceof N&&this.value.template===e)this.value.update(t.values);else{var r=new N(e,t.processor,this.options),n=r._clone();r.update(t.values),this.__commitNode(n),this.value=r}}},{key:"__commitIterable",value:function(t){Array.isArray(this.value)||(this.value=[],this.clear());var e,r=this.value,n=0,i=!0,o=!1,a=void 0;try{for(var s,l=t[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;void 0===(e=r[n])&&(e=new J(this.options),r.push(e),0===n?e.appendIntoPart(this):e.insertAfterPart(r[n-1])),e.setValue(u),e.commit(),n++}}catch(t){o=!0,a=t}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}n<r.length&&(r.length=n,this.clear(e&&e.endNode))}},{key:"clear",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.startNode;f(this.startNode.parentNode,t.nextSibling,this.endNode)}}]),J),U=(l()(Y,[{key:"setValue",value:function(t){this.__pendingValue=t}},{key:"commit",value:function(){for(;o(this.__pendingValue);){var t=this.__pendingValue;this.__pendingValue=A,t(this)}if(this.__pendingValue!==A){var e=!!this.__pendingValue;this.value!==e&&(e?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=e),this.__pendingValue=A}}}]),Y),F=(i=z,b()($,i),l()($,[{key:"_createPart",value:function(){return new W(this)}},{key:"_getValue",value:function(){return this.single?this.parts[0].value:m()(y()($.prototype),"_getValue",this).call(this)}},{key:"commit",value:function(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}]),$),W=(n=H,b()(Z,n),Z),G=!1;function Z(){return M()(this,Z),h()(this,y()(Z).apply(this,arguments))}function $(t,e,r){var n;return M()(this,$),(n=h()(this,y()($).call(this,t,e,r))).single=2===r.length&&""===r[0]&&""===r[1],n}function Y(t,e,r){if(M()(this,Y),this.value=void 0,this.__pendingValue=void 0,2!==r.length||""!==r[0]||""!==r[1])throw new Error("Boolean attributes can only contain a single expression");this.element=t,this.name=e,this.strings=r}function J(t){M()(this,J),this.value=void 0,this.__pendingValue=void 0,this.options=t}function Q(t){M()(this,Q),this.value=void 0,this.committer=t}function X(t,e,r){M()(this,X),this.dirty=!0,this.element=t,this.name=e,this.strings=r,this.parts=[];for(var n=0;n<r.length-1;n++)this.parts[n]=this._createPart()}function K(t,e,r,n){M()(this,K),this.strings=t,this.values=e,this.type=r,this.processor=n}function tt(t,e,r){M()(this,tt),this.__parts=[],this.template=t,this.processor=e,this.options=r}try{var et={get capture(){return!(G=!0)}};window.addEventListener("test",et,et),window.removeEventListener("test",et,et)}catch(t){}var rt=(l()(it,[{key:"setValue",value:function(t){this.__pendingValue=t}},{key:"commit",value:function(){for(;o(this.__pendingValue);){var t=this.__pendingValue;this.__pendingValue=A,t(this)}if(this.__pendingValue!==A){var e=this.__pendingValue,r=this.value,n=null==e||null!=r&&(e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive),i=null!=e&&(null==r||n);n&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),i&&(this.__options=nt(e),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=e,this.__pendingValue=A}}},{key:"handleEvent",value:function(t){"function"==typeof this.value?this.value.call(this.eventContext||this.element,t):this.value.handleEvent(t)}}]),it),nt=function(t){return t&&(G?{capture:t.capture,passive:t.passive,once:t.once}:t.capture)};function it(t,e,r){var n=this;M()(this,it),this.value=void 0,this.__pendingValue=void 0,this.element=t,this.eventName=e,this.eventContext=r,this.__boundHandleEvent=function(t){return n.handleEvent(t)}}function ot(){M()(this,ot)}function at(t){var e=st.get(t.type);void 0===e&&(e={stringsArray:new WeakMap,keyString:new Map},st.set(t.type,e));var r=e.stringsArray.get(t.strings);if(void 0!==r)return r;var n=t.strings.join(R);return void 0===(r=e.keyString.get(n))&&(r=new O(t,t.getTemplateElement()),e.keyString.set(n,r)),e.stringsArray.set(t.strings,r),r}l()(ot,[{key:"handleAttributeExpressions",value:function(t,e,r,n){var i=e[0];return"."===i?new F(t,e.slice(1),r).parts:"@"===i?[new rt(t,e.slice(1),n.eventContext)]:"?"===i?[new U(t,e.slice(1),r)]:new z(t,e,r).parts}},{key:"handleTextExpression",value:function(t){return new B(t)}}]),new ot;var st=new Map,lt=new WeakMap;function ut(t,e){for(var r=t.element.content,n=t.parts,i=document.createTreeWalker(r,133,null,!1),o=ht(n),a=n[o],s=-1,l=0,u=[],c=null;i.nextNode();){s++;var h=i.currentNode;for(h.previousSibling===c&&(c=null),e.has(h)&&(u.push(h),null===c&&(c=h)),null!==c&&l++;void 0!==a&&a.index===s;)a.index=null!==c?-1:a.index-l,a=n[o=ht(n,o)]}u.forEach(function(t){return t.parentNode.removeChild(t)})}(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.1.2");function ct(t){for(var e=11===t.nodeType?0:1,r=document.createTreeWalker(t,133,null,!1);r.nextNode();)e++;return e}function ht(t){for(var e=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1)+1;e<t.length;e++){var r=t[e];if(c(r))return e}return-1}function dt(t,e){return"".concat(t,"--").concat(e)}var pt=!0;void 0===window.ShadyCSS?pt=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),pt=!1);var ft=["html","svg"],vt=new Set,yt=r(9),gt=r.n(yt),mt=r(10),_t=r.n(mt),bt=r(11),wt=r.n(bt);window.JSCompiler_renameProperty=function(t,e){return t};function St(t,e){return e!==t&&(e==e||t==t)}var xt,Pt,At={toAttribute:function(t,e){switch(e){case Boolean:return t?"":null;case Object:case Array:return null==t?t:JSON.stringify(t)}return t},fromAttribute:function(t,e){switch(e){case Boolean:return null!==t;case Number:return null===t?null:Number(t);case Object:case Array:return JSON.parse(t)}return t}},kt={attribute:!0,type:String,converter:At,reflect:!1,hasChanged:St},Et=Promise.resolve(!0),Ct=(xt=wt()(HTMLElement),b()(Tt,xt),l()(Tt,[{key:"initialize",value:function(){this._saveInstanceProperties(),this._requestUpdate()}},{key:"_saveInstanceProperties",value:function(){var n=this;this.constructor._classProperties.forEach(function(t,e){if(n.hasOwnProperty(e)){var r=n[e];delete n[e],n._instanceProperties||(n._instanceProperties=new Map),n._instanceProperties.set(e,r)}})}},{key:"_applyInstanceProperties",value:function(){var r=this;this._instanceProperties.forEach(function(t,e){return r[e]=t}),this._instanceProperties=void 0}},{key:"connectedCallback",value:function(){this._updateState=32|this._updateState,this._hasConnectedResolver&&(this._hasConnectedResolver(),this._hasConnectedResolver=void 0)}},{key:"disconnectedCallback",value:function(){}},{key:"attributeChangedCallback",value:function(t,e,r){e!==r&&this._attributeToProperty(t,r)}},{key:"_propertyToAttribute",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:kt,n=this.constructor,i=n._attributeNameForProperty(t,r);if(void 0!==i){var o=n._propertyValueToAttribute(e,r);if(void 0===o)return;this._updateState=8|this._updateState,null==o?this.removeAttribute(i):this.setAttribute(i,o),this._updateState=-9&this._updateState}}},{key:"_attributeToProperty",value:function(t,e){if(!(8&this._updateState)){var r=this.constructor,n=r._attributeToPropertyMap.get(t);if(void 0!==n){var i=r._classProperties.get(n)||kt;this._updateState=16|this._updateState,this[n]=r._propertyValueFromAttribute(e,i),this._updateState=-17&this._updateState}}}},{key:"_requestUpdate",value:function(t,e){var r=!0;if(void 0!==t){var n=this.constructor,i=n._classProperties.get(t)||kt;n._valueHasChanged(this[t],e,i.hasChanged)?(this._changedProperties.has(t)||this._changedProperties.set(t,e),!0!==i.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(t,i))):r=!1}!this._hasRequestedUpdate&&r&&this._enqueueUpdate()}},{key:"requestUpdate",value:function(t,e){return this._requestUpdate(t,e),this.updateComplete}},{key:"_enqueueUpdate",value:(Pt=_t()(gt.a.mark(function t(){var r,n,e,i,o=this;return gt.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this._updateState=4|this._updateState,e=this._updatePromise,this._updatePromise=new Promise(function(t,e){r=t,n=e}),t.prev=3,t.next=6,e;case 6:t.next=10;break;case 8:t.prev=8,t.t0=t.catch(3);case 10:if(this._hasConnected){t.next=13;break}return t.next=13,new Promise(function(t){return o._hasConnectedResolver=t});case 13:if(t.prev=13,null!=(i=this.performUpdate()))return t.next=18,i;t.next=18;break;case 18:t.next=23;break;case 20:t.prev=20,t.t1=t.catch(13),n(t.t1);case 23:r(!this._hasRequestedUpdate);case 24:case"end":return t.stop()}},t,this,[[3,8],[13,20]])})),function(){return Pt.apply(this,arguments)})},{key:"performUpdate",value:function(){this._instanceProperties&&this._applyInstanceProperties();var t=!1,e=this._changedProperties;try{(t=this.shouldUpdate(e))&&this.update(e)}catch(e){throw t=!1,e}finally{this._markUpdated()}t&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(e)),this.updated(e))}},{key:"_markUpdated",value:function(){this._changedProperties=new Map,this._updateState=-5&this._updateState}},{key:"_getUpdateComplete",value:function(){return this._updatePromise}},{key:"shouldUpdate",value:function(t){return!0}},{key:"update",value:function(t){var r=this;void 0!==this._reflectingProperties&&0<this._reflectingProperties.size&&(this._reflectingProperties.forEach(function(t,e){return r._propertyToAttribute(e,r[e],t)}),this._reflectingProperties=void 0)}},{key:"updated",value:function(t){}},{key:"firstUpdated",value:function(t){}},{key:"_hasConnected",get:function(){return 32&this._updateState}},{key:"_hasRequestedUpdate",get:function(){return 4&this._updateState}},{key:"hasUpdated",get:function(){return 1&this._updateState}},{key:"updateComplete",get:function(){return this._getUpdateComplete()}}],[{key:"_ensureClassProperties",value:function(){var r=this;if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;var t=Object.getPrototypeOf(this)._classProperties;void 0!==t&&t.forEach(function(t,e){return r._classProperties.set(e,t)})}}},{key:"createProperty",value:function(r){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:kt;if(this._ensureClassProperties(),this._classProperties.set(r,t),!t.noAccessor&&!this.prototype.hasOwnProperty(r)){var n="symbol"===S()(r)?Symbol():"__".concat(r);Object.defineProperty(this.prototype,r,{get:function(){return this[n]},set:function(t){var e=this[r];this[n]=t,this._requestUpdate(r,e)},configurable:!0,enumerable:!0})}}},{key:"finalize",value:function(){var t=Object.getPrototypeOf(this);if(t.hasOwnProperty("finalized")||t.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){var e=this.properties,r=[].concat(C()(Object.getOwnPropertyNames(e)),C()("function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[])),n=!0,i=!1,o=void 0;try{for(var a,s=r[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value;this.createProperty(l,e[l])}}catch(t){i=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}}}},{key:"_attributeNameForProperty",value:function(t,e){var r=e.attribute;return!1===r?void 0:"string"==typeof r?r:"string"==typeof t?t.toLowerCase():void 0}},{key:"_valueHasChanged",value:function(t,e){return(2<arguments.length&&void 0!==arguments[2]?arguments[2]:St)(t,e)}},{key:"_propertyValueFromAttribute",value:function(t,e){var r=e.type,n=e.converter||At,i="function"==typeof n?n:n.fromAttribute;return i?i(t,r):t}},{key:"_propertyValueToAttribute",value:function(t,e){if(void 0!==e.reflect){var r=e.type,n=e.converter;return(n&&n.toAttribute||At.toAttribute)(t,r)}}},{key:"observedAttributes",get:function(){var n=this;this.finalize();var i=[];return this._classProperties.forEach(function(t,e){var r=n._attributeNameForProperty(e,t);void 0!==r&&(n._attributeToPropertyMap.set(r,e),i.push(r))}),i}}]),Tt);function Tt(){var t;return M()(this,Tt),(t=h()(this,y()(Tt).call(this)))._updateState=0,t._instanceProperties=void 0,t._updatePromise=Et,t._hasConnectedResolver=void 0,t._changedProperties=new Map,t._reflectingProperties=void 0,t.initialize(),t}Ct.finalized=!0;var Nt="adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype;Symbol(),(window.litElementVersions||(window.litElementVersions=[])).push("2.2.1");var It,Dt=(It=Ct,b()(Ot,It),l()(Ot,[{key:"initialize",value:function(){m()(y()(Ot.prototype),"initialize",this).call(this),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}},{key:"createRenderRoot",value:function(){return this.attachShadow({mode:"open"})}},{key:"adoptStyles",value:function(){var t=this.constructor._styles;0!==t.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?Nt?this.renderRoot.adoptedStyleSheets=t.map(function(t){return t.styleSheet}):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(t.map(function(t){return t.cssText}),this.localName))}},{key:"connectedCallback",value:function(){m()(y()(Ot.prototype),"connectedCallback",this).call(this),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}},{key:"update",value:function(t){var r=this;m()(y()(Ot.prototype),"update",this).call(this,t);var e=this.render();e instanceof D&&this.constructor.render(e,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(function(t){var e=document.createElement("style");e.textContent=t.cssText,r.renderRoot.appendChild(e)}))}},{key:"render",value:function(){}}],[{key:"finalize",value:function(){m()(y()(Ot),"finalize",this).call(this),this._styles=this.hasOwnProperty(JSCompiler_renameProperty("styles",this))?this._getUniqueStyles():this._styles||[]}},{key:"_getUniqueStyles",value:function(){var t,e=this.styles,r=[];return Array.isArray(e)?((t=e).flat?t.flat(1/0):function t(e,r){for(var n=1<arguments.length&&void 0!==r?r:[],i=0,o=e.length;i<o;i++){var a=e[i];Array.isArray(a)?t(a,n):n.push(a)}return n}(t)).reduceRight(function(t,e){return t.add(e),t},new Set).forEach(function(t){return r.unshift(t)}):e&&r.push(e),r}}]),Ot);function Ot(){return M()(this,Ot),h()(this,y()(Ot).apply(this,arguments))}Dt.finalized=!0,Dt.render=function(t,e,r){if(!r||"object"!==S()(r)||!r.scopeName)throw new Error("The `scopeName` option is required.");var n,i,o,a,s,l=r.scopeName,u=lt.has(e),c=pt&&11===e.nodeType&&!!e.host,h=c&&!vt.has(l),d=h?document.createDocumentFragment():e;if(n=t,i=d,o=Object.assign({templateFactory:(s=l,function(t){var e=dt(t.type,s),r=st.get(e);void 0===r&&(r={stringsArray:new WeakMap,keyString:new Map},st.set(e,r));var n=r.stringsArray.get(t.strings);if(void 0!==n)return n;var i=t.strings.join(R);if(void 0===(n=r.keyString.get(i))){var o=t.getTemplateElement();pt&&window.ShadyCSS.prepareTemplateDom(o,s),n=new O(t,o),r.keyString.set(i,n)}return r.stringsArray.set(t.strings,n),n})},r),void 0===(a=lt.get(i))&&(f(i,i.firstChild),lt.set(i,a=new B(Object.assign({templateFactory:at},o))),a.appendInto(i)),a.setValue(n),a.commit(),h){var p=lt.get(d);lt.delete(d),function(t,e,r){vt.add(t);var n,i=r?r.element:document.createElement("template"),o=e.querySelectorAll("style"),a=o.length;if(0!==a){for(var s=document.createElement("style"),l=0;l<a;l++){var u=o[l];u.parentNode.removeChild(u),s.textContent+=u.textContent}n=t,ft.forEach(function(t){var e=st.get(dt(t,n));void 0!==e&&e.keyString.forEach(function(t){var e=t.element.content,r=new Set;Array.from(e.querySelectorAll("style")).forEach(function(t){r.add(t)}),ut(t,r)})});var c=i.content;r?function(t,e,r){var n=2<arguments.length&&void 0!==r?r:null,i=t.element.content,o=t.parts;if(null!=n)for(var a=document.createTreeWalker(i,133,null,!1),s=ht(o),l=0,u=-1;a.nextNode();){for(u++,a.currentNode===n&&(l=ct(e),n.parentNode.insertBefore(e,n));-1!==s&&o[s].index===u;){if(0<l){for(;-1!==s;)o[s].index+=l,s=ht(o,s);return}s=ht(o,s)}}else i.appendChild(e)}(r,s,c.firstChild):c.insertBefore(s,c.firstChild),window.ShadyCSS.prepareTemplateStyles(i,t);var h=c.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==h)e.insertBefore(h.cloneNode(!0),e.firstChild);else if(r){c.insertBefore(s,c.firstChild);var d=new Set;d.add(s),ut(r,d)}}else window.ShadyCSS.prepareTemplateStyles(i,t)}(l,d,p.value instanceof N?p.value.template:void 0),f(e,e.firstChild),e.appendChild(d),lt.set(e,p)}!u&&c&&window.ShadyCSS.styleElement(e.host)};var Mt,Rt=(Mt=Dt,b()(Lt,Mt),l()(Lt,[{key:"validateParams",value:function(){return void 0!==this.pdbId&&void 0!==this.entityId&&void 0!==this.chainId}},{key:"connectedCallback",value:function(){m()(y()(Lt.prototype),"connectedCallback",this).call(this)}},{key:"invokePlugin",value:function(){this.validateParams()&&(void 0===this.viewInstance&&(this.viewInstance=new PdbTopologyViewerPlugin),this.viewInstance.render(this,this.entityId,this.pdbId,this.chainId))}},{key:"updated",value:function(){this.invokePlugin()}},{key:"createRenderRoot",value:function(){return this}}],[{key:"properties",get:function(){return{pdbId:{type:String,attribute:"pdb-id"},entityId:{type:String,attribute:"entity-id"},chainId:{type:String,attribute:"chain-id"}}}}]),Lt);function Lt(){return M()(this,Lt),h()(this,y()(Lt).apply(this,arguments))}e.default=Rt,customElements.define("pdb-topology-viewer",Rt)}]);